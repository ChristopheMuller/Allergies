"0","library(ggplot2)"
"0","library(stringr)"
"0",""
"0","coords.factors <- res.ca$quali.sup$coord[,1:2]"
"0","coords.cols <- res.ca$col$coord[,1:2]"
"0",""
"0",""
"0","for (fac in factors.of.interest){"
"0","  matching_rows <- coords.factors[startsWith(rownames(coords.factors), paste0(fac, ""."")), ]"
"0","  "
"0","  levels <- str_remove(rownames(matching_rows), paste0(fac, ""\\.""))"
"0","  "
"0","  if (fac == ""Région de France"") {"
"0","    levels <- region.france.dict[levels]"
"0","  }"
"0","  "
"0","  if (fac == ""Type d'habitat"") {"
"0","    levels <- type.habitat.dict[levels]"
"0","  }"
"0","  "
"0","  if (fac == ""COFACTEURS généraux"") {"
"0","    levels <- cofacteurs.generaux.dict[levels]"
"0","  }"
"0","  "
"0","  if (fac == ""Sexe"") {"
"0","    levels <- sexe.dict[levels]"
"0","  }"
"0",""
"0","  temp <- data.frame("
"0","    Dim1 = matching_rows[, 1],"
"0","    Dim2 = matching_rows[, 2],"
"0","    Level = levels"
"0","  )"
"0","  "
"0","  p <- ggplot(temp, aes(x = Dim1, y = Dim2, label = Level)) +"
"0","    geom_point(color = ""steelblue"", size = 2) +"
"0","    geom_text(vjust = -0.5, hjust = 0.5) +"
"0","    labs(title = paste(""CA coordinates for:"", fac),"
"0","         x = ""Dimension 1"", y = ""Dimension 2"") +"
"0","    theme_minimal() +"
"0","    xlim(-1, 4) +  "
"0","    ylim(-1, 2)"
"0",""
"0","  print(p)"
"0","}"
